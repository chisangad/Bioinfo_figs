<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 scRNA-seq data | Bioinformatics figures for publication</title>
  <meta name="description" content="This tutorial focuses on generating figures for publications from a bioinformatics analysis in answering Biological questions." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 scRNA-seq data | Bioinformatics figures for publication" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This tutorial focuses on generating figures for publications from a bioinformatics analysis in answering Biological questions." />
  <meta name="github-repo" content="chisangad/bioinf_figures" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 scRNA-seq data | Bioinformatics figures for publication" />
  
  <meta name="twitter:description" content="This tutorial focuses on generating figures for publications from a bioinformatics analysis in answering Biological questions." />
  

<meta name="author" content="David Chisanga and Wei Shi" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bulk-rna-seq-analysis.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://www.onjcri.org.au/our-research/#bcgl">Shi Lab (BCG)@ONJCRI</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>2</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="2.1" data-path="prerequisites.html"><a href="prerequisites.html#prereq"><i class="fa fa-check"></i><b>2.1</b> Data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="prerequisites.html"><a href="prerequisites.html#bulk-rna-seq-data"><i class="fa fa-check"></i><b>2.1.1</b> Bulk RNA-seq data</a></li>
<li class="chapter" data-level="2.1.2" data-path="prerequisites.html"><a href="prerequisites.html#scranseqback"><i class="fa fa-check"></i><b>2.1.2</b> scRNA-seq data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="prerequisites.html"><a href="prerequisites.html#software"><i class="fa fa-check"></i><b>2.2</b> SOFTWARE</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bulk-rna-seq-analysis.html"><a href="bulk-rna-seq-analysis.html"><i class="fa fa-check"></i><b>3</b> Bulk RNA-seq analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bulk-rna-seq-analysis.html"><a href="bulk-rna-seq-analysis.html#background"><i class="fa fa-check"></i><b>3.1</b> Background</a></li>
<li class="chapter" data-level="3.2" data-path="bulk-rna-seq-analysis.html"><a href="bulk-rna-seq-analysis.html#multi-dimensional-scaling-plot-mds-or-pca"><i class="fa fa-check"></i><b>3.2</b> Multi-Dimensional scaling plot (MDS) or PCA</a></li>
<li class="chapter" data-level="3.3" data-path="bulk-rna-seq-analysis.html"><a href="bulk-rna-seq-analysis.html#venn-diagram"><i class="fa fa-check"></i><b>3.3</b> Venn diagram</a></li>
<li class="chapter" data-level="3.4" data-path="bulk-rna-seq-analysis.html"><a href="bulk-rna-seq-analysis.html#mean-difference-plot"><i class="fa fa-check"></i><b>3.4</b> Mean-difference plot</a></li>
<li class="chapter" data-level="3.5" data-path="bulk-rna-seq-analysis.html"><a href="bulk-rna-seq-analysis.html#volcano-plots"><i class="fa fa-check"></i><b>3.5</b> Volcano plots</a></li>
<li class="chapter" data-level="3.6" data-path="bulk-rna-seq-analysis.html"><a href="bulk-rna-seq-analysis.html#heatmaps"><i class="fa fa-check"></i><b>3.6</b> Heatmaps</a></li>
<li class="chapter" data-level="3.7" data-path="bulk-rna-seq-analysis.html"><a href="bulk-rna-seq-analysis.html#dendrogram"><i class="fa fa-check"></i><b>3.7</b> Dendrogram</a></li>
<li class="chapter" data-level="3.8" data-path="bulk-rna-seq-analysis.html"><a href="bulk-rna-seq-analysis.html#pathway-analysis"><i class="fa fa-check"></i><b>3.8</b> Pathway Analysis</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="bulk-rna-seq-analysis.html"><a href="bulk-rna-seq-analysis.html#gene-ontology-enrichment"><i class="fa fa-check"></i><b>3.8.1</b> Gene Ontology enrichment</a></li>
<li class="chapter" data-level="3.8.2" data-path="bulk-rna-seq-analysis.html"><a href="bulk-rna-seq-analysis.html#kegg-pathway-enrichment"><i class="fa fa-check"></i><b>3.8.2</b> KEGG pathway enrichment</a></li>
<li class="chapter" data-level="3.8.3" data-path="bulk-rna-seq-analysis.html"><a href="bulk-rna-seq-analysis.html#gene-set-enrichment-analysis"><i class="fa fa-check"></i><b>3.8.3</b> Gene Set Enrichment Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="scrna-seq-data.html"><a href="scrna-seq-data.html"><i class="fa fa-check"></i><b>4</b> scRNA-seq data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="scrna-seq-data.html"><a href="scrna-seq-data.html#background-1"><i class="fa fa-check"></i><b>4.1</b> Background</a></li>
<li class="chapter" data-level="4.2" data-path="scrna-seq-data.html"><a href="scrna-seq-data.html#tsne-plots"><i class="fa fa-check"></i><b>4.2</b> tSNE plots</a></li>
<li class="chapter" data-level="4.3" data-path="scrna-seq-data.html"><a href="scrna-seq-data.html#umap"><i class="fa fa-check"></i><b>4.3</b> uMAP</a></li>
<li class="chapter" data-level="4.4" data-path="scrna-seq-data.html"><a href="scrna-seq-data.html#heatmaps-1"><i class="fa fa-check"></i><b>4.4</b> Heatmaps</a></li>
<li class="chapter" data-level="4.5" data-path="scrna-seq-data.html"><a href="scrna-seq-data.html#feature-plots"><i class="fa fa-check"></i><b>4.5</b> Feature plots</a></li>
<li class="chapter" data-level="4.6" data-path="scrna-seq-data.html"><a href="scrna-seq-data.html#cell-annotation"><i class="fa fa-check"></i><b>4.6</b> Cell annotation</a></li>
<li class="chapter" data-level="4.7" data-path="scrna-seq-data.html"><a href="scrna-seq-data.html#trajectory-analysis"><i class="fa fa-check"></i><b>4.7</b> Trajectory analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bioinformatics figures for publication</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="scrna-seq-data" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> scRNA-seq data<a href="scrna-seq-data.html#scrna-seq-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="background-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Background<a href="scrna-seq-data.html#background-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As discussed previously <a href="prerequisites.html#scranseqback">2.1.2</a>, processed counts from the <a href="https://chisangad.github.io/scRNAseqtut/index.html">scRNA-seq workshop</a> are used here to demonstrate the different types of figures that can be generated for publications.</p>
</div>
<div id="tsne-plots" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> tSNE plots<a href="scrna-seq-data.html#tsne-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>t-distributed stochastic neighbor embedding (t-SNE) is a statistical method for visualizing high-dimensional data by giving each data point a location in a two or three-dimensional map. It is a dimensionality reduction technique which is a way to graphically simplify very large datasets.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="scrna-seq-data.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Seurat)</span></code></pre></div>
<pre><code>## Attaching SeuratObject</code></pre>
<pre><code>## Attaching sp</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="scrna-seq-data.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-2"><a href="scrna-seq-data.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;Counts_scRNA-norm.RData&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="scrna-seq-data.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(</span>
<span id="cb5-2"><a href="scrna-seq-data.html#cb5-2" aria-hidden="true" tabindex="-1"></a>  counts_st,</span>
<span id="cb5-3"><a href="scrna-seq-data.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">reduction =</span> <span class="st">&quot;tsne&quot;</span>,</span>
<span id="cb5-4"><a href="scrna-seq-data.html#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> T,</span>
<span id="cb5-5"><a href="scrna-seq-data.html#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb5-6"><a href="scrna-seq-data.html#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> T,</span>
<span id="cb5-7"><a href="scrna-seq-data.html#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="fu">DiscretePalette</span>(<span class="fu">length</span>(<span class="fu">levels</span>(<span class="fu">Idents</span>(</span>
<span id="cb5-8"><a href="scrna-seq-data.html#cb5-8" aria-hidden="true" tabindex="-1"></a>    counts_st</span>
<span id="cb5-9"><a href="scrna-seq-data.html#cb5-9" aria-hidden="true" tabindex="-1"></a>  ))))</span>
<span id="cb5-10"><a href="scrna-seq-data.html#cb5-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Bioinfo-figures_files/figure-html/unnamed-chunk-2-1.png" width="960" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="scrna-seq-data.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(</span>
<span id="cb6-2"><a href="scrna-seq-data.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  counts_st,</span>
<span id="cb6-3"><a href="scrna-seq-data.html#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">reduction =</span> <span class="st">&quot;tsne&quot;</span>,</span>
<span id="cb6-4"><a href="scrna-seq-data.html#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> T,</span>
<span id="cb6-5"><a href="scrna-seq-data.html#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.by =</span> <span class="st">&quot;Sample&quot;</span>,</span>
<span id="cb6-6"><a href="scrna-seq-data.html#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb6-7"><a href="scrna-seq-data.html#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> T</span>
<span id="cb6-8"><a href="scrna-seq-data.html#cb6-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Bioinfo-figures_files/figure-html/unnamed-chunk-3-1.png" width="960" /></p>
</div>
<div id="umap" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> uMAP<a href="scrna-seq-data.html#umap" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Optionally, we can also perform dimension reductionality reduction using Uniform Manifold Approximation and Projection (UMAP). UMAP is a dimension reduction technique that can be used for visualization similarly to t-SNE, but also for general non-linear dimension reduction.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="scrna-seq-data.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(</span>
<span id="cb7-2"><a href="scrna-seq-data.html#cb7-2" aria-hidden="true" tabindex="-1"></a>  counts_st,</span>
<span id="cb7-3"><a href="scrna-seq-data.html#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">reduction =</span> <span class="st">&quot;umap&quot;</span>,</span>
<span id="cb7-4"><a href="scrna-seq-data.html#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> T,</span>
<span id="cb7-5"><a href="scrna-seq-data.html#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb7-6"><a href="scrna-seq-data.html#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> T,</span>
<span id="cb7-7"><a href="scrna-seq-data.html#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="fu">DiscretePalette</span>(<span class="fu">length</span>(<span class="fu">levels</span>(<span class="fu">Idents</span>(</span>
<span id="cb7-8"><a href="scrna-seq-data.html#cb7-8" aria-hidden="true" tabindex="-1"></a>    counts_st</span>
<span id="cb7-9"><a href="scrna-seq-data.html#cb7-9" aria-hidden="true" tabindex="-1"></a>  ))))</span>
<span id="cb7-10"><a href="scrna-seq-data.html#cb7-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Bioinfo-figures_files/figure-html/unnamed-chunk-4-1.png" width="768" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="scrna-seq-data.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(</span>
<span id="cb8-2"><a href="scrna-seq-data.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  counts_st,</span>
<span id="cb8-3"><a href="scrna-seq-data.html#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">reduction =</span> <span class="st">&quot;umap&quot;</span>,</span>
<span id="cb8-4"><a href="scrna-seq-data.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> T,</span>
<span id="cb8-5"><a href="scrna-seq-data.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.by =</span> <span class="st">&quot;Sample&quot;</span>,</span>
<span id="cb8-6"><a href="scrna-seq-data.html#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb8-7"><a href="scrna-seq-data.html#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> T</span>
<span id="cb8-8"><a href="scrna-seq-data.html#cb8-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="Bioinfo-figures_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
<p>To identify differentially expressed genes between clusters we can use the <em>FindMarker</em> function in Seurat. As an example, DE genes between clusters 0 and 1 are computed below.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="scrna-seq-data.html#cb9-1" aria-hidden="true" tabindex="-1"></a>DE.cluster0_1 <span class="ot">&lt;-</span> <span class="fu">FindMarkers</span>(</span>
<span id="cb9-2"><a href="scrna-seq-data.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  counts_st,</span>
<span id="cb9-3"><a href="scrna-seq-data.html#cb9-3" aria-hidden="true" tabindex="-1"></a> <span class="at">ident.1 =</span> <span class="dv">0</span>,</span>
<span id="cb9-4"><a href="scrna-seq-data.html#cb9-4" aria-hidden="true" tabindex="-1"></a> <span class="at">ident.2 =</span> <span class="dv">1</span>,</span>
<span id="cb9-5"><a href="scrna-seq-data.html#cb9-5" aria-hidden="true" tabindex="-1"></a> <span class="at">verbose =</span> F)</span>
<span id="cb9-6"><a href="scrna-seq-data.html#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DE.cluster0_1[<span class="fu">order</span>(<span class="fu">abs</span>(DE.cluster0_1<span class="sc">$</span>avg_log2FC), </span>
<span id="cb9-7"><a href="scrna-seq-data.html#cb9-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">decreasing =</span> T),])</span></code></pre></div>
<pre><code>##                p_val avg_log2FC pct.1 pct.2     p_val_adj
## CD74    0.000000e+00  -5.891577 0.008 1.000  0.000000e+00
## IGHM    0.000000e+00  -5.729445 0.000 0.998  0.000000e+00
## S100A6  0.000000e+00   5.598281 1.000 0.047  0.000000e+00
## TMSB4X 1.657565e-278  -4.911549 0.970 1.000 2.935713e-274
## CCL3   6.580286e-308  -4.861987 0.000 0.945 1.165434e-303
## KRT81  4.273972e-296   4.593045 0.962 0.000 7.569632e-292</code></pre>
</div>
<div id="heatmaps-1" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Heatmaps<a href="scrna-seq-data.html#heatmaps-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Marker genes which can be used to uniquely identify each of the clusters are identified using the <em>FindAllMarkers</em> function.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="scrna-seq-data.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb11-2"><a href="scrna-seq-data.html#cb11-2" aria-hidden="true" tabindex="-1"></a>all.markers <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="scrna-seq-data.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="scrna-seq-data.html#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">order_by =</span> avg_log2FC)</span></code></pre></div>
<pre><code>## # A tibble: 35 × 7
## # Groups:   cluster [7]
##        p_val avg_log2FC pct.1 pct.2 p_val_adj cluster gene   
##        &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;   &lt;chr&gt;  
##  1 1.61e-155      1.23  0.94  0.525 2.86e-151 0       IGFBP3 
##  2 4.07e- 65      1.17  0.417 0.149 7.21e- 61 0       IGFBP5 
##  3 2.12e-147      1.06  0.998 0.714 3.75e-143 0       TPM1   
##  4 2.31e-202      0.938 0.994 0.869 4.09e-198 0       CSNK2B 
##  5 1.78e-131      0.901 0.998 0.665 3.15e-127 0       TPM2   
##  6 0              4.79  0.998 0.021 0         1       IGHM   
##  7 0              4.63  1     0.037 0         1       CD74   
##  8 0              4.22  0.945 0.015 0         1       CCL3   
##  9 0              4.08  1     0.959 0         1       TMSB4X 
## 10 0              3.48  0.999 0.033 0         1       HLA-DRA
## # … with 25 more rows
## # ℹ Use `print(n = ...)` to see more rows</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="scrna-seq-data.html#cb13-1" aria-hidden="true" tabindex="-1"></a>top10.markers<span class="ot">&lt;-</span>all.markers <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="scrna-seq-data.html#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="scrna-seq-data.html#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">order_by =</span> avg_log2FC)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="scrna-seq-data.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DoHeatmap</span>(counts_st, <span class="at">features =</span> top10.markers<span class="sc">$</span>gene)</span></code></pre></div>
<p><img src="Bioinfo-figures_files/figure-html/unnamed-chunk-10-1.png" width="960" /></p>
</div>
<div id="feature-plots" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Feature plots<a href="scrna-seq-data.html#feature-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can also highlight the expression of genes of interest on the clusters by way of a tSNE plot.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="scrna-seq-data.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get the top marker gene per cluster</span></span>
<span id="cb15-2"><a href="scrna-seq-data.html#cb15-2" aria-hidden="true" tabindex="-1"></a>top.markers<span class="ot">&lt;-</span>all.markers <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="scrna-seq-data.html#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="scrna-seq-data.html#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">order_by =</span> avg_log2FC)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="scrna-seq-data.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FeaturePlot</span>(</span>
<span id="cb16-2"><a href="scrna-seq-data.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  counts_st,</span>
<span id="cb16-3"><a href="scrna-seq-data.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">features =</span> top.markers<span class="sc">$</span>gene,</span>
<span id="cb16-4"><a href="scrna-seq-data.html#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb16-5"><a href="scrna-seq-data.html#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> T,</span>
<span id="cb16-6"><a href="scrna-seq-data.html#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">reduction =</span> <span class="st">&quot;tsne&quot;</span></span>
<span id="cb16-7"><a href="scrna-seq-data.html#cb16-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Bioinfo-figures_files/figure-html/unnamed-chunk-12-1.png" width="960" /></p>
<p>Alternatively, we can also use violin plots or boxplots to show the expression profile of genes of interest across cells by cluster or any other combination of cells</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="scrna-seq-data.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(counts_st,</span>
<span id="cb17-2"><a href="scrna-seq-data.html#cb17-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">features =</span> top.markers<span class="sc">$</span>gene,</span>
<span id="cb17-3"><a href="scrna-seq-data.html#cb17-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="fu">DiscretePalette</span>(<span class="fu">length</span>(<span class="fu">unique</span>(</span>
<span id="cb17-4"><a href="scrna-seq-data.html#cb17-4" aria-hidden="true" tabindex="-1"></a>          counts_st<span class="sc">$</span>seurat_clusters</span>
<span id="cb17-5"><a href="scrna-seq-data.html#cb17-5" aria-hidden="true" tabindex="-1"></a>        ))))</span></code></pre></div>
<p><img src="Bioinfo-figures_files/figure-html/unnamed-chunk-13-1.png" width="960" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="scrna-seq-data.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb18-2"><a href="scrna-seq-data.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> top.markers<span class="sc">$</span>gene)</span>
<span id="cb18-3"><a href="scrna-seq-data.html#cb18-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb18-4"><a href="scrna-seq-data.html#cb18-4" aria-hidden="true" tabindex="-1"></a>  n.data <span class="ot">&lt;-</span> counts_st[n, ]</span>
<span id="cb18-5"><a href="scrna-seq-data.html#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">boxplot</span>(</span>
<span id="cb18-6"><a href="scrna-seq-data.html#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(n.data<span class="sc">@</span>assays<span class="sc">$</span>RNA<span class="sc">@</span>data) <span class="sc">~</span> <span class="fu">as.character</span>(n.data<span class="sc">$</span>seurat_clusters),</span>
<span id="cb18-7"><a href="scrna-seq-data.html#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">DiscretePalette</span>(<span class="fu">length</span>(<span class="fu">unique</span>(</span>
<span id="cb18-8"><a href="scrna-seq-data.html#cb18-8" aria-hidden="true" tabindex="-1"></a>      counts_st<span class="sc">$</span>seurat_clusters</span>
<span id="cb18-9"><a href="scrna-seq-data.html#cb18-9" aria-hidden="true" tabindex="-1"></a>    ))),</span>
<span id="cb18-10"><a href="scrna-seq-data.html#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Cluster&quot;</span>,</span>
<span id="cb18-11"><a href="scrna-seq-data.html#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Expression Level&quot;</span>,</span>
<span id="cb18-12"><a href="scrna-seq-data.html#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> n</span>
<span id="cb18-13"><a href="scrna-seq-data.html#cb18-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-14"><a href="scrna-seq-data.html#cb18-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Bioinfo-figures_files/figure-html/unnamed-chunk-14-1.png" width="960" /></p>
</div>
<div id="cell-annotation" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Cell annotation<a href="scrna-seq-data.html#cell-annotation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An unbiased cell type recognition is performed using <strong>SingleR</strong>. <strong>celldex</strong> has a range of annotations derived from Bulk RNA-seq data that can be used to annotate the identified clusters above. Here, we use the Human Primary Cell Atlas database as an example.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="scrna-seq-data.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SingleR)</span>
<span id="cb19-2"><a href="scrna-seq-data.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SingleCellExperiment)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="scrna-seq-data.html#cb20-1" aria-hidden="true" tabindex="-1"></a>cell.sce<span class="ot">&lt;-</span> <span class="fu">as.SingleCellExperiment</span>(counts_st)</span>
<span id="cb20-2"><a href="scrna-seq-data.html#cb20-2" aria-hidden="true" tabindex="-1"></a>annot<span class="ot">&lt;-</span>celldex<span class="sc">::</span><span class="fu">HumanPrimaryCellAtlasData</span>()</span>
<span id="cb20-3"><a href="scrna-seq-data.html#cb20-3" aria-hidden="true" tabindex="-1"></a>cell.annots <span class="ot">&lt;-</span> <span class="fu">SingleR</span>(</span>
<span id="cb20-4"><a href="scrna-seq-data.html#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">test =</span> cell.sce,</span>
<span id="cb20-5"><a href="scrna-seq-data.html#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> annot,</span>
<span id="cb20-6"><a href="scrna-seq-data.html#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">clusters =</span> cell.sce<span class="sc">$</span>seurat_clusters,</span>
<span id="cb20-7"><a href="scrna-seq-data.html#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> annot<span class="sc">$</span>label.main)</span>
<span id="cb20-8"><a href="scrna-seq-data.html#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="scrna-seq-data.html#cb20-9" aria-hidden="true" tabindex="-1"></a>cell.annots.fine<span class="ot">&lt;-</span><span class="fu">SingleR</span>(</span>
<span id="cb20-10"><a href="scrna-seq-data.html#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">test =</span> cell.sce,</span>
<span id="cb20-11"><a href="scrna-seq-data.html#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> annot,</span>
<span id="cb20-12"><a href="scrna-seq-data.html#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">clusters =</span> cell.sce<span class="sc">$</span>seurat_clusters,</span>
<span id="cb20-13"><a href="scrna-seq-data.html#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> annot<span class="sc">$</span>label.fine)</span>
<span id="cb20-14"><a href="scrna-seq-data.html#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="scrna-seq-data.html#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(cell.annots,cell.annots.fine,<span class="at">file =</span> <span class="st">&quot;Annotations.RData&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="scrna-seq-data.html#cb21-1" aria-hidden="true" tabindex="-1"></a>counts_st <span class="ot">&lt;-</span></span>
<span id="cb21-2"><a href="scrna-seq-data.html#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">AddMetaData</span>(counts_st, cell.annots[<span class="fu">match</span>(counts_st<span class="sc">@</span>meta.data<span class="sc">$</span>seurat_clusters,<span class="fu">rownames</span>(cell.annots)), <span class="st">&quot;labels&quot;</span>], <span class="st">&quot;Annot.main&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="scrna-seq-data.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="scrna-seq-data.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(</span>
<span id="cb23-2"><a href="scrna-seq-data.html#cb23-2" aria-hidden="true" tabindex="-1"></a>    counts_st,</span>
<span id="cb23-3"><a href="scrna-seq-data.html#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">reduction =</span> <span class="st">&quot;tsne&quot;</span>,</span>
<span id="cb23-4"><a href="scrna-seq-data.html#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">group.by =</span> <span class="st">&quot;Annot.main&quot;</span>,</span>
<span id="cb23-5"><a href="scrna-seq-data.html#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> T,</span>
<span id="cb23-6"><a href="scrna-seq-data.html#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> T,</span>
<span id="cb23-7"><a href="scrna-seq-data.html#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.size =</span> <span class="fl">0.1</span>,</span>
<span id="cb23-8"><a href="scrna-seq-data.html#cb23-8" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="Bioinfo-figures_files/figure-html/unnamed-chunk-20-1.png" width="960" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="scrna-seq-data.html#cb24-1" aria-hidden="true" tabindex="-1"></a>counts_st <span class="ot">&lt;-</span> <span class="fu">AddMetaData</span>(counts_st, cell.annots.fine[<span class="fu">match</span>(counts_st<span class="sc">@</span>meta.data<span class="sc">$</span>seurat_clusters, <span class="fu">rownames</span>(cell.annots.fine)), <span class="st">&quot;labels&quot;</span>], <span class="st">&quot;Annot.fine&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="scrna-seq-data.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(</span>
<span id="cb25-2"><a href="scrna-seq-data.html#cb25-2" aria-hidden="true" tabindex="-1"></a>  counts_st,</span>
<span id="cb25-3"><a href="scrna-seq-data.html#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">reduction =</span> <span class="st">&quot;tsne&quot;</span>,</span>
<span id="cb25-4"><a href="scrna-seq-data.html#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.by =</span> <span class="st">&quot;Annot.fine&quot;</span>,</span>
<span id="cb25-5"><a href="scrna-seq-data.html#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> T,</span>
<span id="cb25-6"><a href="scrna-seq-data.html#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> T,</span>
<span id="cb25-7"><a href="scrna-seq-data.html#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pt.size =</span> <span class="fl">0.1</span></span>
<span id="cb25-8"><a href="scrna-seq-data.html#cb25-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="Bioinfo-figures_files/figure-html/unnamed-chunk-22-1.png" width="960" /></p>
</div>
<div id="trajectory-analysis" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Trajectory analysis<a href="scrna-seq-data.html#trajectory-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Pseudotime is a measure of how much progress an individual cell has made through a process such as cell differentiation.</p>
<!-- In many biological processes, cells do not progress in perfect synchrony. In single-cell expression studies of processes such as cell differentiation, captured cells might be widely distributed in terms of progress. That is, in a population of cells captured at exactly the same time, some cells might be far along, while others might not yet even have begun the process. This asynchrony creates major problems when you want to understand the sequence of regulatory changes that occur as cells transition from one state to the next. Tracking the expression across cells captured at the same time produces a very compressed sense of a gene's kinetics, and the apparent variability of that gene's expression will be very high. -->
<!-- By ordering each cell according to its progress along a learned trajectory, Monocle alleviates the problems that arise due to asynchrony. Instead of tracking changes in expression as a function of time, Monocle tracks changes as a function of progress along the trajectory, which we term "pseudotime". Pseudotime is an abstract unit of progress: it's simply the distance between a cell and the start of the trajectory, measured along the shortest path. The trajectory's total length is defined in terms of the total amount of transcriptional change that a cell undergoes as it moves from the starting state to the end state.](https://cole-trapnell-lab.github.io/monocle3/docs/trajectories/#order-cells:~:text=What%20is-,pseudotime,-%3F) -->
<p>Pseudotime analysis of the cells identified in the dataset was performed using <strong>Monocle2</strong>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="scrna-seq-data.html#cb26-1" aria-hidden="true" tabindex="-1"></a>mono2.learn.traject <span class="ot">&lt;-</span></span>
<span id="cb26-2"><a href="scrna-seq-data.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(X_counts,</span>
<span id="cb26-3"><a href="scrna-seq-data.html#cb26-3" aria-hidden="true" tabindex="-1"></a>           these.cell.types) {</span>
<span id="cb26-4"><a href="scrna-seq-data.html#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(monocle) <span class="co"># It has to be Monocle 2.</span></span>
<span id="cb26-5"><a href="scrna-seq-data.html#cb26-5" aria-hidden="true" tabindex="-1"></a>    rds.fname <span class="ot">&lt;-</span><span class="st">&quot;Trajectory-cds.rds&quot;</span></span>
<span id="cb26-6"><a href="scrna-seq-data.html#cb26-6" aria-hidden="true" tabindex="-1"></a>    gsndf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">gene_short_name =</span> <span class="fu">rownames</span>(X_counts))</span>
<span id="cb26-7"><a href="scrna-seq-data.html#cb26-7" aria-hidden="true" tabindex="-1"></a>    csndf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cell.type =</span> these.cell.types)</span>
<span id="cb26-8"><a href="scrna-seq-data.html#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames</span>(gsndf) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(X_counts)</span>
<span id="cb26-9"><a href="scrna-seq-data.html#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames</span>(csndf) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(X_counts)</span>
<span id="cb26-10"><a href="scrna-seq-data.html#cb26-10" aria-hidden="true" tabindex="-1"></a>    pd <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;AnnotatedDataFrame&quot;</span>, <span class="at">data =</span> csndf)</span>
<span id="cb26-11"><a href="scrna-seq-data.html#cb26-11" aria-hidden="true" tabindex="-1"></a>    fd <span class="ot">&lt;-</span> <span class="fu">new</span>(<span class="st">&quot;AnnotatedDataFrame&quot;</span>, <span class="at">data =</span> gsndf)</span>
<span id="cb26-12"><a href="scrna-seq-data.html#cb26-12" aria-hidden="true" tabindex="-1"></a>    cds <span class="ot">&lt;-</span></span>
<span id="cb26-13"><a href="scrna-seq-data.html#cb26-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">newCellDataSet</span>(</span>
<span id="cb26-14"><a href="scrna-seq-data.html#cb26-14" aria-hidden="true" tabindex="-1"></a>        X_counts,</span>
<span id="cb26-15"><a href="scrna-seq-data.html#cb26-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">phenoData =</span> pd,</span>
<span id="cb26-16"><a href="scrna-seq-data.html#cb26-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">featureData =</span> fd,</span>
<span id="cb26-17"><a href="scrna-seq-data.html#cb26-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">expressionFamily =</span> <span class="fu">negbinomial.size</span>()</span>
<span id="cb26-18"><a href="scrna-seq-data.html#cb26-18" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb26-19"><a href="scrna-seq-data.html#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(cds)</span>
<span id="cb26-20"><a href="scrna-seq-data.html#cb26-20" aria-hidden="true" tabindex="-1"></a>    cds <span class="ot">&lt;-</span> <span class="fu">estimateSizeFactors</span>(cds)</span>
<span id="cb26-21"><a href="scrna-seq-data.html#cb26-21" aria-hidden="true" tabindex="-1"></a>    cds <span class="ot">&lt;-</span> <span class="fu">estimateDispersions</span>(cds)</span>
<span id="cb26-22"><a href="scrna-seq-data.html#cb26-22" aria-hidden="true" tabindex="-1"></a>    cds <span class="ot">&lt;-</span> <span class="fu">detectGenes</span>(cds, <span class="at">min_expr =</span> <span class="fl">0.1</span>)</span>
<span id="cb26-23"><a href="scrna-seq-data.html#cb26-23" aria-hidden="true" tabindex="-1"></a>    disp_table <span class="ot">&lt;-</span> <span class="fu">dispersionTable</span>(cds)</span>
<span id="cb26-24"><a href="scrna-seq-data.html#cb26-24" aria-hidden="true" tabindex="-1"></a>    ordering_genes <span class="ot">&lt;-</span> <span class="fu">subset</span>(disp_table, mean_expression <span class="sc">&gt;=</span> <span class="fl">0.1</span>)</span>
<span id="cb26-25"><a href="scrna-seq-data.html#cb26-25" aria-hidden="true" tabindex="-1"></a>    cds <span class="ot">&lt;-</span> <span class="fu">setOrderingFilter</span>(cds, ordering_genes)</span>
<span id="cb26-26"><a href="scrna-seq-data.html#cb26-26" aria-hidden="true" tabindex="-1"></a>    cds <span class="ot">&lt;-</span> <span class="fu">reduceDimension</span>(cds)</span>
<span id="cb26-27"><a href="scrna-seq-data.html#cb26-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">saveRDS</span>(cds , rds.fname)</span>
<span id="cb26-28"><a href="scrna-seq-data.html#cb26-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="scrna-seq-data.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mono2.learn.traject</span>(</span>
<span id="cb27-2"><a href="scrna-seq-data.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  X_counts <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(counts_st<span class="sc">@</span>assays<span class="sc">$</span>RNA<span class="sc">@</span>counts),</span>
<span id="cb27-3"><a href="scrna-seq-data.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  these.cell.types <span class="ot">&lt;-</span> counts_st[[]]<span class="sc">$</span>seurat_clusters</span>
<span id="cb27-4"><a href="scrna-seq-data.html#cb27-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="scrna-seq-data.html#cb28-1" aria-hidden="true" tabindex="-1"></a>mono.rds <span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">&quot;Trajectory-cds.rds&quot;</span>)</span>
<span id="cb28-2"><a href="scrna-seq-data.html#cb28-2" aria-hidden="true" tabindex="-1"></a>mono.Tree <span class="ot">&lt;-</span> <span class="fu">t</span>(mono.rds<span class="sc">@</span>reducedDimS)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="scrna-seq-data.html#cb29-1" aria-hidden="true" tabindex="-1"></a>do.Traj.lines <span class="ot">&lt;-</span> <span class="cf">function</span>(traj) {</span>
<span id="cb29-2"><a href="scrna-seq-data.html#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(traj<span class="sc">@</span>minSpanningTree[[]])) {</span>
<span id="cb29-3"><a href="scrna-seq-data.html#cb29-3" aria-hidden="true" tabindex="-1"></a>    p1no <span class="ot">&lt;-</span> <span class="fu">unlist</span>(traj<span class="sc">@</span>minSpanningTree[[i]])[<span class="dv">1</span>]</span>
<span id="cb29-4"><a href="scrna-seq-data.html#cb29-4" aria-hidden="true" tabindex="-1"></a>    p2no <span class="ot">&lt;-</span> <span class="fu">unlist</span>(traj<span class="sc">@</span>minSpanningTree[[i]])[<span class="dv">2</span>]</span>
<span id="cb29-5"><a href="scrna-seq-data.html#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(</span>
<span id="cb29-6"><a href="scrna-seq-data.html#cb29-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(traj<span class="sc">@</span>reducedDimK[<span class="dv">1</span>, p1no],</span>
<span id="cb29-7"><a href="scrna-seq-data.html#cb29-7" aria-hidden="true" tabindex="-1"></a>        traj<span class="sc">@</span>reducedDimK[<span class="dv">1</span>, p2no]),</span>
<span id="cb29-8"><a href="scrna-seq-data.html#cb29-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(traj<span class="sc">@</span>reducedDimK[<span class="dv">2</span>, p1no],</span>
<span id="cb29-9"><a href="scrna-seq-data.html#cb29-9" aria-hidden="true" tabindex="-1"></a>        traj<span class="sc">@</span>reducedDimK[<span class="dv">2</span>, p2no]),</span>
<span id="cb29-10"><a href="scrna-seq-data.html#cb29-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb29-11"><a href="scrna-seq-data.html#cb29-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-12"><a href="scrna-seq-data.html#cb29-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-13"><a href="scrna-seq-data.html#cb29-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="scrna-seq-data.html#cb30-1" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> counts_st[[]]<span class="sc">$</span>seurat_clusters</span>
<span id="cb30-2"><a href="scrna-seq-data.html#cb30-2" aria-hidden="true" tabindex="-1"></a>cols.traj <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;purple&quot;</span>,<span class="st">&quot;pink&quot;</span>)</span>
<span id="cb30-3"><a href="scrna-seq-data.html#cb30-3" aria-hidden="true" tabindex="-1"></a>traj.cols <span class="ot">&lt;-</span>  cols.traj[clusters]</span>
<span id="cb30-4"><a href="scrna-seq-data.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb30-5"><a href="scrna-seq-data.html#cb30-5" aria-hidden="true" tabindex="-1"></a>    mono.Tree,</span>
<span id="cb30-6"><a href="scrna-seq-data.html#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.7</span>,</span>
<span id="cb30-7"><a href="scrna-seq-data.html#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb30-8"><a href="scrna-seq-data.html#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg =</span> traj.cols,</span>
<span id="cb30-9"><a href="scrna-seq-data.html#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> traj.cols,</span>
<span id="cb30-10"><a href="scrna-seq-data.html#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Component 1&quot;</span>,</span>
<span id="cb30-11"><a href="scrna-seq-data.html#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Component 2&quot;</span>,</span>
<span id="cb30-12"><a href="scrna-seq-data.html#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis =</span> <span class="fl">0.8</span>,</span>
<span id="cb30-13"><a href="scrna-seq-data.html#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.lab =</span> <span class="fl">0.9</span></span>
<span id="cb30-14"><a href="scrna-seq-data.html#cb30-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-15"><a href="scrna-seq-data.html#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="fu">do.Traj.lines</span>(mono.rds)</span>
<span id="cb30-16"><a href="scrna-seq-data.html#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb30-17"><a href="scrna-seq-data.html#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;bottomright&quot;</span>,</span>
<span id="cb30-18"><a href="scrna-seq-data.html#cb30-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">levels</span>(clusters),</span>
<span id="cb30-19"><a href="scrna-seq-data.html#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb30-20"><a href="scrna-seq-data.html#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> cols.traj,</span>
<span id="cb30-21"><a href="scrna-seq-data.html#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb30-22"><a href="scrna-seq-data.html#cb30-22" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Bioinfo-figures_files/figure-html/unnamed-chunk-27-1.png" width="768" /></p>
<p><strong>Session info</strong></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="scrna-seq-data.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.2.0 (2022-04-22)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur/Monterey 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_AU.UTF-8/en_AU.UTF-8/en_AU.UTF-8/C/en_AU.UTF-8/en_AU.UTF-8
## 
## attached base packages:
## [1] stats4    stats     graphics  grDevices utils     datasets  methods  
## [8] base     
## 
## other attached packages:
##  [1] SingleCellExperiment_1.18.0 SingleR_1.10.0             
##  [3] SummarizedExperiment_1.26.1 Biobase_2.56.0             
##  [5] GenomicRanges_1.48.0        GenomeInfoDb_1.32.2        
##  [7] IRanges_2.30.0              S4Vectors_0.34.0           
##  [9] BiocGenerics_0.42.0         MatrixGenerics_1.8.1       
## [11] matrixStats_0.62.0          dplyr_1.0.9                
## [13] ggplot2_3.3.6               sp_1.5-0                   
## [15] SeuratObject_4.1.0          Seurat_4.1.1               
## 
## loaded via a namespace (and not attached):
##   [1] VGAM_1.1-7                plyr_1.8.7               
##   [3] igraph_1.3.4              lazyeval_0.2.2           
##   [5] splines_4.2.0             BiocParallel_1.30.3      
##   [7] listenv_0.8.0             scattermore_0.8          
##   [9] fastICA_1.2-3             digest_0.6.29            
##  [11] htmltools_0.5.3           viridis_0.6.2            
##  [13] fansi_1.0.3               magrittr_2.0.3           
##  [15] ScaledMatrix_1.4.0        tensor_1.5               
##  [17] cluster_2.1.3             ROCR_1.0-11              
##  [19] limma_3.52.2              globals_0.15.1           
##  [21] docopt_0.7.1              spatstat.sparse_2.1-1    
##  [23] colorspace_2.0-3          ggrepel_0.9.1            
##  [25] xfun_0.31                 sparsesvd_0.2            
##  [27] RCurl_1.98-1.8            jsonlite_1.8.0           
##  [29] progressr_0.10.1          spatstat.data_2.2-0      
##  [31] survival_3.3-1            zoo_1.8-10               
##  [33] glue_1.6.2                polyclip_1.10-0          
##  [35] gtable_0.3.0              zlibbioc_1.42.0          
##  [37] XVector_0.36.0            leiden_0.4.2             
##  [39] DelayedArray_0.22.0       BiocSingular_1.12.0      
##  [41] future.apply_1.9.0        abind_1.4-5              
##  [43] scales_1.2.0              pheatmap_1.0.12          
##  [45] DBI_1.1.3                 spatstat.random_2.2-0    
##  [47] miniUI_0.1.1.1            Rcpp_1.0.9               
##  [49] viridisLite_0.4.0         xtable_1.8-4             
##  [51] reticulate_1.25           spatstat.core_2.4-4      
##  [53] rsvd_1.0.5                htmlwidgets_1.5.4        
##  [55] httr_1.4.3                RColorBrewer_1.1-3       
##  [57] ellipsis_0.3.2            ica_1.0-3                
##  [59] pkgconfig_2.0.3           farver_2.1.1             
##  [61] sass_0.4.2                uwot_0.1.11              
##  [63] deldir_1.0-6              utf8_1.2.2               
##  [65] tidyselect_1.1.2          labeling_0.4.2           
##  [67] rlang_1.0.4               reshape2_1.4.4           
##  [69] later_1.3.0               munsell_0.5.0            
##  [71] tools_4.2.0               cachem_1.0.6             
##  [73] cli_3.3.0                 generics_0.1.3           
##  [75] ggridges_0.5.3            evaluate_0.15            
##  [77] stringr_1.4.0             fastmap_1.1.0            
##  [79] yaml_2.3.5                goftest_1.2-3            
##  [81] knitr_1.39                fitdistrplus_1.1-8       
##  [83] DDRTree_0.1.5             purrr_0.3.4              
##  [85] RANN_2.6.1                sparseMatrixStats_1.8.0  
##  [87] pbapply_1.5-0             future_1.27.0            
##  [89] nlme_3.1-158              mime_0.12                
##  [91] slam_0.1-50               monocle_2.24.1           
##  [93] ggrastr_1.0.1             compiler_4.2.0           
##  [95] rstudioapi_0.13           beeswarm_0.4.0           
##  [97] plotly_4.10.0             png_0.1-7                
##  [99] spatstat.utils_2.3-1      tibble_3.1.8             
## [101] bslib_0.4.0               stringi_1.7.8            
## [103] highr_0.9                 rgeos_0.5-9              
## [105] lattice_0.20-45           Matrix_1.4-1             
## [107] HSMMSingleCell_1.16.0     vctrs_0.4.1              
## [109] pillar_1.8.0              lifecycle_1.0.1          
## [111] combinat_0.0-8            spatstat.geom_2.4-0      
## [113] lmtest_0.9-40             jquerylib_0.1.4          
## [115] BiocNeighbors_1.14.0      RcppAnnoy_0.0.19         
## [117] data.table_1.14.2         cowplot_1.1.1            
## [119] bitops_1.0-7              irlba_2.3.5              
## [121] httpuv_1.6.5              patchwork_1.1.1          
## [123] R6_2.5.1                  bookdown_0.27            
## [125] promises_1.2.0.1          KernSmooth_2.23-20       
## [127] gridExtra_2.3             vipor_0.4.5              
## [129] parallelly_1.32.1         codetools_0.2-18         
## [131] MASS_7.3-58.1             assertthat_0.2.1         
## [133] leidenbase_0.1.11         withr_2.5.0              
## [135] qlcMatrix_0.9.7           sctransform_0.3.3        
## [137] GenomeInfoDbData_1.2.8    mgcv_1.8-40              
## [139] parallel_4.2.0            beachmat_2.12.0          
## [141] grid_4.2.0                rpart_4.1.16             
## [143] tidyr_1.2.0               DelayedMatrixStats_1.18.0
## [145] rmarkdown_2.14            Rtsne_0.16               
## [147] shiny_1.7.2               ggbeeswarm_0.6.0</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bulk-rna-seq-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-scRNAseq.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Bioinfo-figures.pdf", "Bioinfo-figures.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
